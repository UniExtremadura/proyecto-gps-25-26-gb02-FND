<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carrito - OverSound</title>
    <link rel="stylesheet" href="{{ url_for('static', path='styles/header.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', path='styles/cart.css') }}">
</head>
<body>
    {% include 'common/header.html' %}
    
    <div class="cart-container">
        <!-- Header del Carrito -->
        <div class="cart-header">
            <h1>Mi Carrito</h1>
            <p>Revisa y completa tu compra</p>
        </div>

        <div class="cart-content">
            <!-- Sección de Productos -->
            <div class="cart-items-section">
                <div id="cart-items" class="cart-items">
                    <!-- Los productos se cargarán aquí -->
                </div>

                <!-- Mensaje de carrito vacío -->
                <div id="empty-cart" class="empty-cart" style="display: none;">
                    <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <circle cx="9" cy="21" r="1"></circle>
                        <circle cx="20" cy="21" r="1"></circle>
                        <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                    </svg>
                    <h3>Tu carrito está vacío</h3>
                    <p>¡Añade algunos productos para comenzar!</p>
                    <a href="/shop" class="btn-continue-shopping">Volver a la Tienda</a>
                </div>
            </div>

            <!-- Resumen del Pedido -->
            <aside class="cart-summary">
                <div class="summary-header">
                    <h2>Resumen del Pedido</h2>
                </div>

                <div class="summary-content" id="summary-content">
                    <div class="summary-item">
                        <span>Subtotal:</span>
                        <span id="subtotal">€0.00</span>
                    </div>
                    <div class="summary-item">
                        <span>IVA (21%):</span>
                        <span id="tax">€0.00</span>
                    </div>
                    <div class="summary-divider"></div>
                    <div class="summary-item total">
                        <span>Total:</span>
                        <span id="total">€0.00</span>
                    </div>

                    <div id="checkout-section">
                        <button id="btn-checkout" class="btn-checkout" disabled>
                            Proceder al Pago
                        </button>
                        <a href="/shop" class="btn-continue-shopping-link">
                            ← Continuar Comprando
                        </a>
                    </div>

                    <div id="no-payment-method" class="no-payment-method" style="display: none;">
                        <p class="warning-text">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
                            </svg>
                            Necesitas un método de pago para continuar
                        </p>
                        <button id="btn-add-payment" class="btn-add-payment">
                            Agregar Método de Pago
                        </button>
                    </div>

                    <div id="not-authenticated" class="not-authenticated" style="display: none;">
                        <p class="warning-text">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
                            </svg>
                            Inicia sesión o regístrate para continuar
                        </p>
                        <div class="auth-buttons">
                            <a href="/login" class="btn-login">Iniciar Sesión</a>
                            <a href="/register" class="btn-register">Registrarse</a>
                        </div>
                    </div>
                </div>

                <!-- Selección de Método de Pago -->
                <div class="payment-selection-section" id="payment-selection-section" style="display: none;">
                    <div class="payment-selection-header">
                        <h2>Seleccionar Método de Pago</h2>
                        <p class="payment-selection-subtitle">Elige cómo deseas pagar tu compra</p>
                    </div>

                    <div class="payment-methods-grid" id="payment-methods-grid">
                        <!-- Métodos de pago cargados dinámicamente -->
                    </div>
                </div>
            </aside>
        </div>
    </div>

    <!-- Modal de confirmación para eliminar producto -->
    <div id="delete-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <h3>Confirmar eliminación</h3>
            <p id="modal-message">¿Estás seguro de que deseas eliminar este producto del carrito?</p>
            <div class="modal-actions">
                <button id="modal-cancel" class="btn-cancel">Cancelar</button>
                <button id="modal-confirm-delete" class="btn-delete-confirm">Eliminar</button>
            </div>
        </div>
    </div>

    <!-- Modal de dirección de envío -->
    <div id="shipping-modal" class="modal" style="display: none;">
        <div class="modal-content shipping-form">
            <h3>Dirección de Envío</h3>
            <form id="shipping-form">
                <div class="form-group">
                    <label for="full-name">Nombre Completo</label>
                    <input type="text" id="full-name" name="full-name" required>
                </div>

                <div class="form-group">
                    <label for="address">Dirección</label>
                    <input type="text" id="address" name="address" required>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="city">Ciudad</label>
                        <input type="text" id="city" name="city" required>
                    </div>
                    <div class="form-group">
                        <label for="postal-code">Código Postal</label>
                        <input type="text" id="postal-code" name="postal-code" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="country">País</label>
                    <input type="text" id="country" name="country" required>
                </div>

                <div class="form-group">
                    <label for="phone">Teléfono</label>
                    <input type="tel" id="phone" name="phone" required>
                </div>

                <div class="modal-actions">
                    <button type="button" id="form-cancel" class="btn-cancel">Cancelar</button>
                    <button type="submit" class="btn-confirm">Confirmar Dirección</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Notificación flotante -->
    <div id="cart-notification" class="notification" style="display: none;">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="20 6 9 17 4 12"></polyline>
        </svg>
        <span id="notification-text"></span>
    </div>

    <!-- Footer -->
    <footer class="cart-footer">
        <div class="footer-content">
            <div class="footer-section">
                <h3>OverSound</h3>
                <p>La mejor tienda de música online</p>
            </div>
            <div class="footer-section">
                <h4>Ayuda</h4>
                <ul>
                    <li><a href="/help">Centro de Ayuda</a></li>
                    <li><a href="/contact">Contacto</a></li>
                    <li><a href="/faq">Preguntas Frecuentes</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Política</h4>
                <ul>
                    <li><a href="/terms">Términos</a></li>
                    <li><a href="/privacy">Privacidad</a></li>
                    <li><a href="/cookies">Cookies</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 OverSound. Todos los derechos reservados.</p>
        </div>
    </footer>

    <script>var TYA_SERVER = '{{ data.tya_server }}';</script>
    <script src="/static/js/cart.js?v=7"></script>
</body>
</html>
